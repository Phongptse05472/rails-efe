<head>

  <%= stylesheet_link_tag 'course_detail', media: 'all', 'data-turbolinks-track': 'reload' %>
  <%= stylesheet_pack_tag 'course_detail', media: 'all', 'data-turbolinks-track': 'reload' %>
</head>
<div class="right">
  <div class="top">
    <h1><%= @course.name %></h1>
    <span>by</span>
    <span><%= @course.author %></span>
    <div class="intro">
      <% if !@course.image.nil? %>
        <%= cl_image_tag(@course.image) %>
      <% else %>
        <%= cl_image_tag('img/some-tips-to-understand-the-need-of-education-erp-software-blog-image564276_ggsimy.png') %>
      <% end %>

      <span id="des" onclick="showmore()"><%= @course.description %><br></span>
      <br>
    </div>
    <% if current_user.present? %>
      <% check_archived_course = CustomerCourse.where('customer_id = ? AND course_id = ? AND enrollment_date IS NOT null', current_user.id, @course.id) %>
      <% if check_archived_course.blank? %>
        <!--          user not enroll this course-->
        <p>Progress(0%)</p>
        <progress max="100" value="0"></progress>
      <% else %>
        <!--       user enrolled in course-->
        <% check_archived_course.each do |course_detail| %>
          <p>Progress(<%= course_detail.progression %>%)</p>
          <progress max="100" value="<%= course_detail.progression %>"></progress>
        <% end %>
      <% end %>
    <% else %>
      <p>Progress(0%)</p>
      <progress max="100" value="0"></progress>
    <% end %>
    <%= button_to enroll_to_course_path(@course.id), method: :post do %>
      Start learn
    <% end %>
    <div class="skill_set">
      <h2>Skill set</h2>
      <ul>
        <% @skill.each do |skill| %>
          <li>
            <span class="out_side_level">
              <%= skill.name %>
              <% @skill_level.each do |f| %>
              <% case f.level_id.to_int %>
              <% when 1 %>
                  <span class="level_skill">
                <%= image_tag("sign_1.PNG", alt: "") %>
              </span>
                <% when 2 %>
               <span class="level_skill">
                <%= image_tag("sign_2.PNG", alt: "") %>
              </span>
                <% when 3 %>
              <span class="level_skill">
                <%= image_tag("sign_3.PNG", alt: "") %>
              </span>
                <% else %>
              <span class="level_skill">
                <%= image_tag("sign_4.PNG", alt: "") %>
              </span>
           <% end %>
            <% end %>
                </span>
              </li>
        <% end %>
      </ul>
    </div>

  </div>
  <div class="buttom">
    <h2>List Article in '<%= @course.name %>'</h2>
    <% @list_article_paging.each do |a| %>
      <div class="per-course">
        <div class="c-left">
          <a href="#">
            <% if !a.video.nil? %>
              <%= cl_video_tag(a.video, :effect => "preview", :resource_type => "video") %>
            <% else %>
              <%= image_tag('japanese.png') %>
            <% end %>
          </a>
        </div>
        <div class="c-right">
          <%= link_to a.title, click_on_article_path(@course, a.id) %>
          <span>
          <%= a.description %>
        </span>
        </div>
        <i class="fa fa-check-circle" aria-hidden="true"></i>
      </div>
    <% end %>
  </div>
  <div class="paging">
    <% if @list_articles.ids.count > 5 %>
      <%== pagy_nav(@pagy) %>
    <% else %>
    <% end %>
  </div>
  <div class="end">
  </div>
</div>
<script>
    var count = -1;
    <% @list_articles.each do | full | %>
    count++;
    <% @list_article_viewed.each do |view| %>
    <% if view.article_id == full.id %>
    document.querySelectorAll('.fa-check-circle')[count].style.display = 'inline-block';
    <% end %>
    <% end %>
    <% end %>
    function showmore() {
        if (document.getElementById('des').style.webkitLineClamp == "inherit") {
            document.getElementById('des').style.webkitLineClamp = "12";
        } else {
            document.getElementById('des').style.webkitLineClamp = "inherit";
        }

    }
</script>

<script>

</script>

<script>
    var perfEntries = performance.getEntriesByType("navigation");

    if (perfEntries[0].type === "back_forward") {
        location.reload(true);
    }
</script>






