<head>
  <%= stylesheet_link_tag 'upload', media: 'all', 'data-turbolinks-track': 'reload' %>
</head>
<div class="right">
  <div class="process">
    <div class="process">
      <a href="#">
        <i class="fa fa-step-backward" aria-hidden="true"></i>
      </a>
      <a href="#">
        <i class="fa fa-check-circle active" aria-hidden="true"></i>
      </a>
      <a href="#">
        <i class="fa fa-check-circle" aria-hidden="true"></i>
      </a>
      <a href="#">
        <i class="fa fa-check-circle" aria-hidden="true"></i>
      </a>
      <a href="#">
        <i class="fa fa-step-forward" aria-hidden="true"></i>
      </a>
    </div>
  </div>
  <%= form_tag  do %>
    <div class="create_course">
      <div class="per_row">
        <div class="row-left">
        <h2>Course Image</h2>
        </div>
        <div class="row-right">
          <div class="thum">
            <i class="fa fa-camera" aria-hidden="true"></i>
            <p id="selectedFileName">Upload avatar</p>
            <input type="button" id="input-file" onchange="changeText()">
          </div>
        </div>
      </div>
      <div class="per_row">
        <div class="row-left">
          <h2>Title</h2>
        </div>
        <div class="row-right">
          <textarea onkeyup="countChar(this)" wrap="hard" rows="2" maxlength="300" class="title_article" name="title"></textarea>
        </div>
      </div>
      <div class="per_row">
        <div class="row-left">
          <h2>Description</h2>
        </div>
        <div class="row-right">
          <textarea class="desc_course" name="description"></textarea>
        </div>
      </div>
      <div class="per_row">
        <div class="row-left">
          <h2>Group</h2>
        </div>
        <div class="row-right-group">
          <select class="js-example-basic-multiple group-select" name="states[]" multiple="multiple">
            <option value="programming">Programming languages</option>
            <option value="client-script">Client Scripts</option>
          </select>
        </div>
      </div>
      <div class="per_row">
        <div class="row-left">
          <h2>Is free</h2>
        </div>
        <label class="container_input">isFree
          <%= f.check_box :is_free %>
          <span class="checkmark"></span>
        </label>
      </div>
      <div class="per_row_article">
        <div class="row-left">
          <h2>Prerequisites</h2>
        </div>
        <div class="row-right">
          <select onchange="resetSkill()" id="skill" class="select_skill">
            <option>-------------------Choose skill-------------------</option>
            <option>Java core</option>
            <option>Java web</option>
            <option>Javascript core</option>
            <option>Spring boot</option>
          </select>
          <div class="skill_level">
            <label onclick="setSkill()" class="container_input">Beginner
              <input type="radio" name="level"  value="Beginner">
              <span class="checkmark"></span>
            </label>
            <label onclick="setSkill()" class="container_input">Intermediate
              <input type="radio" name="level" value="Intermediate">
              <span class="checkmark"></span>
            </label>
            <label onclick="setSkill()" class="container_input">Advanced
              <input type="radio" name="level" value="Advanced">
              <span class="checkmark"></span>
            </label>
          </div>
        </div>
      </div>
      <div class="per_row_article">
        <div class="row-left">

        </div>
        <div class="row-right">
          <table id="table">
            <tr>

            </tr>
          </table>

        </div>
      </div>
      <br>
      <button type="submit">Create course</button>
    </div>
  <% end %>
  <div class="end">
  </div>
</div>
<script>
  var arr=[];
  function resetSkill(){
      var levels = document.getElementsByName('level');
      for (var i = 0; i < levels.length; i++) {
          if (levels[i].checked) {
              levels[i].checked=false;
          }
      }
  }
  function setSkill() {
      var levels = document.getElementsByName('level');
      var level;
      for (var i = 0; i < levels.length; i++) {
          if (levels[i].checked) {
              level = levels[i].value;
          }
      }

      if (level != undefined) {
          var skill = document.getElementById('skill').value;
          if(document.getElementById('skill').selectedIndex==0){
              return;
          }
          var object = {s:skill,l:level};
          for(var i=0; i<arr.length; i++){
              if(skill==arr[i].s && level==arr[i].l){
                  return;
              }
          }
          arr.push(object);
          var tr = document.createElement('tr');
          tr.innerHTML = `
                  <td> <p>${skill}</p></td>
                  <td>
                      <p>${level}</p>
                      </td>
                      <td>
                          <i onclick="removeSkill(this,'${skill}','${level}')" class="fa fa-times" aria-hidden="true"></i>
                      </td>
                  `;
          document.getElementById('table').tBodies[0].appendChild(tr);
      }
  }
  function removeSkill(i,skill,level){

      i.parentNode.parentNode.remove();
      for(var i=0; i<arr.length; i++){
          if(skill==arr[i].s && level==arr[i].l){
              arr.splice(i, 1);
              break;
          }
      }
      resetSkill();
  }
  $(document).ready(function() {
    $('.js-example-basic-multiple').select2();
  });
</script>
